% Template for the Cleanthesis LaTeX class.
% Mostly based on the Reed College LaTeX thesis template used in the
% {thesisdown} package (by Sam Noble, Ben Salzberg, Jess Youngberg, and
% Chester Ismay).

% **************************************************
% Document Class Definition
% **************************************************
\documentclass[%
    paper=A4,               % paper size
    twoside=true,           % onesite or twoside printing
    openright,              % doublepage cleaning ends up right side
    parskip=half,           % spacing value / method for paragraphs
    chapterprefix=true,     % prefix for chapter marks
    11pt,                   % font size
    headings=normal,        % size of headings
    bibliography=totoc,     % include bib in toc
    listof=notoc,           % include listof entries in toc
    titlepage=on,           % own page for each title page
    captions=tableabove,    % display table captions above the float env
    chapterprefix=false,    % do not display a prefix for chapters
    appendixprefix=false,   % but display a prefix for appendix chapter
    draft=false,            % value for draft version
]{scrreprt}%


% **************************************************
% Information and Commands for Reuse
% (obtained from YAML)
% **************************************************
\newcommand{\thesisTitle}{$title$}
\newcommand{\thesisAuthor}{$author$}
\newcommand{\thesisSubject}{$title$}
\newcommand{\thesisDate}{$date$}
\newcommand{\thesisNnt}{$nnt$}

\newcommand{\thesisUniversity}{$institution$}
\newcommand{\thesisUniversityDepartment}{$department$}
\newcommand{\thesisEdNumber}{$ednumber$}
\newcommand{\thesisEdName}{$edname$}
\newcommand{\thesisPrivacy}{$privacy$}


% **************************************************
% Files' Character Encoding
% **************************************************
\PassOptionsToPackage{utf8}{inputenc}
\usepackage{inputenc}


% **************************************************
% Load and Configure Packages
% **************************************************
\usepackage[english]{babel} % babel system, adjust the language of the content
\PassOptionsToPackage{% setup clean thesis style
    figuresep=colon,%
    hangfigurecaption=false,%
    hangsection=true,%
    hangsubsection=true,%
    sansserif=false,%
    configurelistings=true,%
    colorize=full,%
    colortheme=bluemagenta,%
    configurebiblatex=true,%
    bibsys=biber,%
    bibfile=$bibliography$,%
    bibstyle=alphabetic,%
    bibsorting=nty,%
}{cleanthesis}
\usepackage{cleanthesis}

\hypersetup{% setup the hyperref-package options
    pdftitle={\thesisTitle},    %   - title (PDF meta)
    pdfsubject={\thesisSubject},%   - subject (PDF meta)
    pdfauthor={\thesisAuthor},  %   - author (PDF meta)
    plainpages=false,           %   -
    colorlinks=true,            %   - colorize links
    linkcolor=ctcolormain,      %   - color of links ('main' from cleanthesis)
    pdfborder={0 0 0},          %   -
    breaklinks=true,            %   - allow line break inside links
    bookmarksnumbered=true,     %
    bookmarksopen=true          %
}


% **************************************************
% Other Packages
% **************************************************
% We disable the setspace hack, as it produces warnings
% (potentially unsupported setspace version).
\PassOptionsToPackage{setspace=false}{scrhack}
\usepackage{scrhack}

\usepackage{graphicx,latexsym}
\usepackage{amsmath}
\usepackage{amssymb,amsthm}
\usepackage{longtable,booktabs,setspace}
\usepackage{xurl}  % allows more line breaks in URLs
\usepackage{hyperref}
\usepackage{lmodern}
\usepackage{float}
\floatplacement{figure}{H}
\usepackage{calc}
\usepackage{rotating}

\usepackage{tabularx}

\usepackage[ruled,algochapter]{algorithm2e}


% **************************************************
% Various setup
% **************************************************

% Use ref for internal links
\renewcommand{\hyperref}[2][???]{\autoref{#1}}
\def\chapterautorefname{Chapter}
\def\sectionautorefname{Section}
\def\subsectionautorefname{Subsection}

\usepackage{caption}
\captionsetup{width=5in}

% We need to declare this character for the MARL table in SOTA
\DeclareUnicodeCharacter{1D701}{\ensuremath{\zeta}}

% \usepackage{times} % other fonts are available like times, bookman, charter, palatino

% Syntax highlighting #22
$if(highlighting-macros)$
  $highlighting-macros$
$endif$

%%% Copied from knitr
%% maxwidth is the original width if it's less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

% From {rticles}
$if(csl-refs)$
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
% for Pandoc 2.8 to 2.10.1
\newenvironment{cslreferences}%
  {$if(csl-hanging-indent)$\setlength{\parindent}{0pt}%
  \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces$endif$}%
  {\par}
% For Pandoc 2.11+
% As noted by @mirh [2] is needed instead of [3] for 2.12
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1 \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces\fi
  % set entry spacing
  \ifnum #2 > 0
  \setlength{\parskip}{#2\baselineskip}
  \fi
 }%
 {}
\usepackage{calc} % for calculating minipage widths
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}
$endif$

$for(header-includes)$
	$header-includes$
$endfor$

% Line spacing
%\usepackage{setspace}\onehalfspacing

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\usepackage[paper=a4paper]{geometry}

% **************************************************
% Setting title pages
% **************************************************
\renewcommand{\maketitle}{%
  {\pagestyle{empty}
  \fontsize{14}{16}\selectfont
  \newgeometry{margin=1in}
  \begin{titlepage}
  \newpage
  \setlength{\parskip}{0pt}

  \begin{figure}
    \centering
    \includegraphics[width=0.5\linewidth]{figure/lyon1.jpeg}
  \end{figure}
  
  {\small N\(^{\circ}\)ordre NNT: \thesisNnt}
  
  \begin{center}

    \textbf{THÈSE de DOCTORAT DE} \\
    \textbf{\thesisUniversity}
    
    \vspace{1em}

    \textbf{École Doctorale} \thesisEdNumber \\
    \textbf{\thesisEdName}
    
    \vspace{1em}

    \textbf{Discipline : \thesisUniversityDepartment}
    
    \vspace{3em}

    Soutenue {\thesisPrivacy} le \thesisDate, par : \\
    {\Large \textbf{\thesisAuthor}}
    
    \vspace{3em}

    \hrule
    \vspace{1.5em}
    \textbf{\LARGE \thesisTitle}
    \vspace{1.5em}
    \hrule

  \end{center}

  \vfill

  {\noindent Devant le jury composé de :}
  \vspace{1em}

  {\small
  \hspace*{-2cm} \begin{tabularx}{\linewidth}{lllr}
    GHODOUS Parisa & Professeure & Université Claude Bernard Lyon 1 & {\color{red}Présidente} \\
    \\
    BONNET Grégory & Maître de conférences HDR & Université de Caen Normandie & {\color{red}Rapporteur} \\
    SLAVKOVIK Marija & Professeure & Université de Bergen & {\color{red}Rapporteure} \\
    \\
    DUTECH Alain & Chargé de recherche HDR & INRIA Nancy & {\color{red}Examinateur} \\
    RODRÍGUEZ-AGUILAR Juan A. & Professeur & Université autonome de Barcelone & {\color{red}Examinateur} \\
    \\
    HASSAS Salima & Professeure & Université Claude Bernard Lyon 1 & {\color{red}Directrice de thèse} \\
    BOISSIER Olivier & Professeur & École des Mines de Saint-Étienne & {\color{red}Co-directeur de thèse} \\
    GUILLERMIN Mathieu & Maître de conférences & Université Catholique de Lyon & {\color{red}Co-directeur de thèse} \\
  \end{tabularx}
  }

  \end{titlepage}
  }
}

% \newgeometry{margin=1in}

% **************************************************
% Document CONTENT
% **************************************************
\begin{document}

% uncomment the following command to fill up pages with
% whitespace instead of aligning the first and last lines
% of a page (see \raggedbottom vs. \flushbottom)
%\raggedbottom

% --------------------------
% rename document parts
% --------------------------

% > set short label names for floating environments figure and table
\renewcaptionname{english}{\figurename}{Fig.}
\renewcaptionname{english}{\tablename}{Tab.}

\renewcommand{\contentsname}{Table of Contents}

\title{\thesisTitle}

% --------------------------
% Front matter
% --------------------------
\pagenumbering{roman}			% roman page numbing (invisible for empty page style)
\pagestyle{empty}				% no header or footers

% Title pages
$if(title)$
  \maketitle
$endif$

\cleardoublepage

\pagestyle{plain}				% display just page numbers

% Add a fake chapter for the "bookmarks"
\pdfbookmark[0]{Preliminary content}{Preliminary content}

% Abstract
$if(abstract)$
  \phantomsection
%  \addcontentsline{toc}{section}{Abstract}
  \pdfbookmark[1]{Abstract}{Abstract}
  \addchap*{Abstract}
  \label{sec:abstract}
  $abstract$
  \cleardoublepage
$endif$

$if(abstract_fr)$
  \phantomsection
%  \addcontentsline{toc}{section}{Résumé (Fr)}
  % We must use \detokenize because of the special characters
  \pdfbookmark[1]{Résumé (Fr)}{\detokenize{Résumé (Fr)}}
  \addchap*{Résumé (Fr)}
%  {\usekomafont{chapter}Résumé (Fr)}
  \label{sec:abstract-fr}
  $abstract_fr$
  \cleardoublepage
$endif$

$if(summary_fr)$
  \phantomsection
%  \addcontentsline{toc}{section}{Résumé substantiel}
  % We must use \detokenize because of the special characters
  \pdfbookmark[1]{Résumé substantiel}{\detokenize{Résumé substantiel}}
  \addchap*{Résumé substantiel}
  \label{sec:summary-fr}
  $summary_fr$
  \cleardoublepage
$endif$

% Acknowledgments
$if(acknowledgements)$
  \phantomsection
%  \addcontentsline{toc}{section}{Acknowledgments}
  \pdfbookmark[1]{Acknowledgments}{Acknowledgments}
  \addchap*{Acknowledgments}
  \label{sec:acknowledgments}
  $acknowledgements$
  \cleardoublepage
$endif$

% Preface
$if(preface)$
  \phantomsection
%  \addcontentsline{toc}{section}{Preface}
  \pdfbookmark[1]{Preface}{Preface}
  \addchap*{Preface}
  \label{sec:preface}
  $preface$
  \cleardoublepage
$endif$

% Dedication
$if(dedication)$
  \phantomsection
%  \addcontentsline{toc}{section}{Dedication}
  \pdfbookmark[1]{Dedication}{Dedication}
  \addchap*{Dedication}
  \label{sec:dedication}
  $dedication$
  \cleardoublepage
$endif$

% Table of contents, figures, listings, ...
% We encapsulate in a group with hypersetup to disable links color temporarily
\begingroup
\hypersetup{linkcolor=black}
% Temporarily set the ToC level to 1 so that bookmarks go under the "Preliminary content" fake-chapter
\makeatletter
\def\toclevel@chapter{1}
\makeatother
\currentpdfbookmark{\contentsname}{toc}
\setcounter{tocdepth}{2}		% define depth of toc
  \tableofcontents				% display table of contents

  \cleardoublepage
  \phantomsection
  \addcontentsline{toc}{section}{List of Figures}
  \listoffigures

  \cleardoublepage
  \phantomsection
  \addcontentsline{toc}{section}{List of Tables}
  \listoftables

  % Note: `\listofalgorithms` does not create a bookmark nor a line in the ToC.
  % We add one ourselves by using `\addcontentsline`. However, this line must
  % correspond to the beginning of the page on which the List of Algorithms
  % appear: `\cleardoublepage` and `\phantomsection` are used to do this.
  \cleardoublepage
  \phantomsection
  \addcontentsline{toc}{section}{List of Algorithms}
  \listofalgorithms
% Revert the ToC level to 0
\makeatletter
\def\toclevel@chapter{0}
\makeatother
\endgroup
\cleardoublepage

% --------------------------
% Body matter
% --------------------------
\pagenumbering{arabic}			% arabic page numbering
\setcounter{page}{1}			% set page counter
\pagestyle{scrheadings}			% header and footer style

$body$

% --------------------------
% Back matter
% --------------------------
%
\cleardoublepage

\newpage
\mbox{}

% **************************************************
% End of Document CONTENT
% **************************************************
\end{document}
